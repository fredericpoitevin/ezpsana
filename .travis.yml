# Do not edit, generated automatically
# by the create-container.py script.
# Last updated on: 2021-03-26T17:51:50-07:00

#on:
#  tags: true
#    all_branches: true
#    condition: "$TRAVIS_TAG =~ ^build-.*$"

sudo: required

language: python

services:
  - docker

env:
  global:
    - secure: travisEncryptedDOCKER_ACCOUNT
    - secure: travisEncryptedDOCKER_PASSWORD

before_install:
  - pip install yaml docker jinja2
  - export PATH=$PATH:$HOME/.local/bin

script:
  - python create-container.py -r slaclcls -t ana -v 4.0.20-py3 -o current.yml -b yaml/ana-latest-py3.yml
  - docker build --build-arg inputyaml=current.yaml --build-arg psana_version=ana:4.0.20-py3  -tag slaclcls/ana:4.0.20-py3 docker

after_success:
  - docker login -u $DOCKER_ACCOUNT -p $DOCKER_PASS
  - docker push slaclcls/ana:4.0.20-py3
